<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dual Iframe View</title>
  <style>
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      display: flex;
      width: 100%;
      height: 90vh;
    }
    iframe {
      border: black 1px;
      flex: 1;
      border: none;
    }

    /* Mobile Styling */
    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        height: 100vh; /* Ensures both iframes fit */
      }
      iframe {
        border: 3px solid black; /* Border hinzugef√ºgt */
        border-radius: 8px; /* Abgerundete Ecken */
        background-color: white;
        transform: scale(0.40);
        position:absolute;
        left:-20%;
        top:-40%;
        width: 140%;
        height: 130vh; /* Forces each iframe to take full viewport height */
      }
    }

  </style>
  <script>
    function updateIframes(semid = null) {
      const currentTime = Math.floor(Date.now() / 1000);
      const oneWeekLater = currentTime + 7 * 24 * 60 * 60; // Add 7 days in seconds

      if (!semid) {
        semid = localStorage.getItem("semid") || "375";
      }
      const url1 = `https://gera.dhge.de/Stundenplan/planung/plan.php?datum=${currentTime}&semid=${semid}`;
      const url2 = `https://gera.dhge.de/Stundenplan/planung/plan.php?datum=${oneWeekLater}&semid=${semid}`;

      document.getElementById("iframe1").src = url1;
      document.getElementById("iframe2").src = url2;
    }

    function extractSemidFromUrl(url) {
      try {
        const urlObj = new URL(url);
        return urlObj.searchParams.get("semid");
      } catch (error) {
        return null;
      }
    }

    function monitorIframeChanges(iframe) {
      iframe.addEventListener("load", () => {
        const semid = extractSemidFromUrl(iframe.src);
        if (semid && semid !== localStorage.getItem("semid")) {
          localStorage.setItem("semid", semid);
          updateIframes(semid);
        }
      });
    }

    function saveSemidFromDropdown() {
      const semid = document.getElementById("semidSelect").value;
      localStorage.setItem("semid", semid);
      updateIframes(semid);
    }

    window.onload = () => {
      updateIframes();
      monitorIframeChanges(document.getElementById("iframe1"));
      monitorIframeChanges(document.getElementById("iframe2"));
    };
  </script>
</head>
<body>
<div>
  <label style="z-index:2" for="semidSelect">Select Semester:</label>
  <select style="z-index:2;position:absolute;right:5%;" id="semidSelect" onchange="saveSemidFromDropdown()">
    <option value="0">Choose</option>
    <option value="375">PIA</option>
    <option value="376">PIB</option>
    <option value="379">PIC</option>
    <option value="378">WI</option>
  </select>
</div>
<div class="container">
  <iframe style="z-index:1;" id="iframe1"></iframe>
  <iframe style="top:5%; z-index: 0;" id="iframe2"></iframe>
</div>
</body>
</html>
